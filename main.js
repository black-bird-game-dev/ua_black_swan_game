(()=>{"use strict";function e(e,n){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e))||n&&e&&"number"==typeof e.length){r&&(e=r);var a=0,o=function(){};return{s:o,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,c=!0,i=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return c=e.done,e},e:function(e){i=!0,s=e},f:function(){try{c||null==r.return||r.return()}finally{if(i)throw s}}}}function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}!function(){var t,n,r,a,o,s,c=document.getElementById("gameCanvas"),i=c.getContext("2d"),l=!1,u=75,d=1,f=3,m=[],g=100,p=100,y=.4*g,v=.4*p,h=[],w=310,b=!1,I=0,E=0,x=0,S=1.5,B=3,L=.75,_=10,k=!1,M=!1,A=0,T=.2,D=30,C="Arial, sans-serif",q=60,O=q,G="black",R=.5,j=!1,z=document.getElementById("audio-loop-2"),H=document.getElementById("audio-explosion"),N={background:{src:"assets/png/BG_1.png"},car:{src:"assets/png/car.png"},road:{src:"assets/png/road.jpg"},cursor:{src:"assets/png/cursor.png"},obstacle:{src:"assets/png/tree.png"},explosion:{src:"assets/png/boom.png"},logo_swan:{src:"assets/png/logo.png"},timerIcon:{src:"assets/png/timer.png"},leftButton:{src:"assets/png/bttn.png"},rightButton:{src:"assets/png/bttn.png"},welcome_bg:{src:"assets/png/BG_1.png"},logo_txt:{src:"assets/png/LOGO_txt.png"},sec60_logo:{src:"assets/png/60sec-logo.png"},play_button:{src:"assets/png/BTTN-Blue.png"},game_over_bg:{src:"assets/png/BG_win.png"},screen_from_movie:{src:"assets/png/Screen-from-movie.png"},youtube_btn:{src:"assets/png/youtube_btn.png"},mono_btn:{src:"assets/png/mono.png"},privat_btn:{src:"assets/png/privat.png"}};document.addEventListener("DOMContentLoaded",$),document.addEventListener("DOMContentLoaded",(function(){var e=document.getElementById("welcome-screen"),t=document.getElementById("play-button"),n=document.querySelector(".youtube-button"),r=document.querySelector(".support-buttons");document.getElementById("game-over").style.display="none",document.getElementById("game-over").style.opacity="0",function(){var a=0,o=Object.keys(N).length;for(var s in N){var i=new Image;i.onload=function(){++a===o&&(e.style.backgroundImage="url(".concat(N.welcome_bg.src,")"),e.style.display="flex",n.addEventListener("click",(function(){z.pause()})),r.addEventListener("click",(function(){z.pause()})),j=!1,t.addEventListener("click",(function(){z.play(),e.style.display="none",c.style.display="block",j=!0,J(),P=1e3/60,X=Date.now(),oe()})))},i.src=N[s].src,N[s].element=i}}()})),c.addEventListener("click",U),c.addEventListener("touchstart",U);var P,X,Y=0,F=200;function U(e){if(!k){var r=Date.now();if(!(r-Y<F)){var a="click"===e.type?e.clientX:e.touches[0].clientX;("click"===e.type?e.clientY:e.touches[0].clientY)>n-80-20&&(a<100&&d>0?(d--,Y=r):a>t-80-20&&d<f-1&&(d++,Y=r)),se()}}}function W(){t=window.innerWidth,n=window.innerHeight,c.width=t,c.height=n,a=t/f*d+(t/f-u)/2}function $(){document.getElementById("welcome-screen"),document.getElementById("play-button"),document.querySelector(".logo-txt"),document.querySelector(".sec60-logo")}function J(){j&&(document.querySelector(".tutorial-popup")||((r=document.createElement("div")).className="tutorial-popup",r.innerHTML='\n        <h2>Виконай рятувальну місію!</h2>\n        <div class="separator"></div> \x3c!-- Белая линия --\x3e\n        <p>Оминай перешкоди, тиснучи на стрілки.\n        <br>В тебе <b>'.concat(O,' </b> секунд.</br></p>\n        <div class="separator"></div> \x3c!-- Белая линия --\x3e\n        <h2>Успіху!</h2>\n    '),document.body.appendChild(r),c.addEventListener("click",(function(){K(),se()}))))}function K(){j=!1,r&&(r.style.display="none")}function Q(){var e=Math.floor(Math.random()*f),n=t/f*e+(t/f-g)/2,r=60*(Math.random()-.5);m.push({x:n,y:-p,rotation:r})}function V(){var e=Math.random()*t/2,n=-w;h.push({x:e,y:n,frame:0,timer:0,delay:60*L})}function Z(){E=0,x=0,H.pause(),H.currentTime=0,b=!1}function ee(){k=!0,M=!0,A=0,clearInterval(ne),clearInterval(re),b=!0,H.pause(),H.currentTime=0}window.addEventListener("resize",W),W(),window.addEventListener("resize",$);var te,ne,re,ae=Date.now();function oe(){var r,c,S;requestAnimationFrame(oe),ae=Date.now(),(te=ae-X)>P&&(X=ae-te%P,i.clearRect(0,0,t,n),c=N.road.element,S=i.createPattern(c,"repeat"),i.fillStyle=S,i.save(),i.translate(E,x),i.translate(0,I),i.fillRect(0,-c.height,t,n+c.height),i.restore(),k||(I+=13)>=c.height&&(I=0),(r=i.createLinearGradient(0,0,0,120)).addColorStop(0,"rgba(0, 0, 0, 0.7)"),r.addColorStop(1,"rgba(0, 0, 0, 0)"),i.fillStyle=r,i.fillRect(0,0,t,120),function(){var t,r=N.obstacle.element,a=e(m);try{for(a.s();!(t=a.n()).done;){var o=t.value;i.save(),i.translate(o.x+g/2+E,o.y+p/2+x),i.rotate(o.rotation*Math.PI/180),i.drawImage(r,-g/2,-p/2,g,p),i.restore(),k||(o.y+=13)}}catch(e){a.e(e)}finally{a.f()}k||(m=m.filter((function(e){return e.y<n})))}(),function(){var t,r=N.explosion.element,a=Math.sqrt(25),o=r.width/a,s=r.height/a,c=e(h);try{for(c.s();!(t=c.n()).done;){var l=t.value;if(!(l.y>=n))if(l.delay>0)l.delay,l.delay--,k||(l.y+=13);else{if(l.frame<25){var u=l.frame%a*o,d=Math.floor(l.frame/a)*s;i.drawImage(r,u,d,o,s,l.x+E,l.y+x,310,w),b||(H.play(),b=!0),k||(l.timer+=1,l.timer>=1&&(l.frame++,l.timer=0,E=Math.random()*_-_/2,x=Math.random()*_-_/2,setTimeout(Z,1e3*L)))}k||(l.y+=13)}}}catch(e){c.e(e)}finally{c.f()}k||(h=h.filter((function(e){return e.y<n&&e.frame<25})))}(),function(){var e=N.car.element;a+=.2*(t/f*d+(t/f-u)/2-a);var r=n-150-100;i.drawImage(e,a+E,r+x,u,150)}(),function(){var e=80,r=N.leftButton.element;i.drawImage(r,20,n-e-20,e,e);var a=N.rightButton.element;i.save(),i.scale(-1,1),i.drawImage(a,20-t,n-e-20,e,e),i.restore()}(),k||(function(){var t,r=e(m);try{for(r.s();!(t=r.n()).done;){var o=t.value,s=o.x+g/2,c=o.y+p/2;if(a+u>s-y/2&&a<s+y/2&&n-10>c-v/2&&n-150-10<c+v/2)return!0}}catch(e){r.e(e)}finally{r.f()}return!1}()&&ee(),function(){if(l){var e=Date.now();s=Math.floor((e-o)/1e3),(O=Math.max(q-s,0))<=0&&ee()}!function(){i.save(),i.font="".concat(D,"px ").concat(C),i.fillStyle="#ffffff";var e=N.logo_swan.element;if(i.drawImage(e,5,5,100,100),l){var n=N.timerIcon.element,r=Math.floor(O/60),a=O%60,o="".concat(String(r).padStart(2,"0"),":").concat(String(a).padStart(2,"0")),s=i.measureText(o).width,c=(i.measureText(o).height,20+.5*(30+D)),u=t/2-(80+s)/2;i.drawImage(n,u,20,30,30);var d=u+30+10;i.fillText(o,d,c)}i.restore()}()}()),k&&function(){var e,r;M&&(A+=T)>=1&&(A=1,M=!1),e=G,r=R*A,i.save(),i.fillStyle=e,i.globalAlpha=r,i.fillRect(0,0,t,n),i.restore();var a=document.getElementById("game-over");a.style.opacity=A,a.style.display="flex",document.getElementById("time").innerText=s}(),l||J())}function se(){l||k||(l=!0,o=Date.now(),ne=setInterval(Q,1e3*S),re=setInterval(V,1e3*B),K())}c.addEventListener("click",se),c.addEventListener("touchstart",se),window.addEventListener("keydown",(function(e){if(l&&!k){var t=Date.now();if(t-Y<F)return;"ArrowLeft"===e.key&&d>0?(d--,Y=t):"ArrowRight"===e.key&&d<f-1&&(d++,Y=t)}se()})),window.onload=function(){W(),k=!1,M=!1,l=!1,o=null,s=0,m=[],h=[]}}()})();